{"version":3,"file":"extension.js","mappings":"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","sources":["../../external commonjs \"vscode\"","../.././src/ui/ViewProvider.ts","../.././src/ui/messaging.ts","../.././src/core/agentFsm.ts","../../external node-commonjs \"events\"","../.././src/core/configManager.ts","../.././src/core/sessionManager.ts","../.././node_modules/uuid/dist/esm-node/v4.js","../.././node_modules/uuid/dist/esm-node/native.js","../../external node-commonjs \"crypto\"","../.././node_modules/uuid/dist/esm-node/rng.js","../.././node_modules/uuid/dist/esm-node/stringify.js","../.././node_modules/uuid/dist/esm-node/validate.js","../.././node_modules/uuid/dist/esm-node/regex.js","../.././src/core/llm/factory.ts","../.././src/core/llm/providers/qwen.ts","../.././src/core/llm/providers/base.ts","../../webpack/bootstrap","../../webpack/runtime/compat get default export","../../webpack/runtime/define property getters","../../webpack/runtime/hasOwnProperty shorthand","../../webpack/runtime/make namespace object","../.././src/extension.ts"],"sourcesContent":["module.exports = require(\"vscode\");","\r\nimport * as vscode from 'vscode';\r\nimport * as path from 'path';\r\nimport * as fs from 'fs';\r\nimport { MessagingService } from './messaging';\r\nimport { AgentFSM } from '../core/agentFsm';\r\nimport { ConfigManager } from '../core/configManager';\r\nimport { SessionManager } from '../core/sessionManager';\r\nimport { LLMFactory } from '../core/llm/factory';\r\nimport { ILLMProvider } from '../core/llm/types';\r\nimport { McpClientService } from '../services/mcpClient';\r\nimport { UserAction } from '../api/types';\r\n\r\nexport class AIChatViewProvider implements vscode.WebviewViewProvider {\r\n    public static readonly viewType = 'nexaide.chatView';\r\n\r\n    private messaging: MessagingService;\r\n    private fsm: AgentFSM;\r\n    private config: ConfigManager;\r\n    private session: SessionManager;\r\n    private llmProvider: ILLMProvider | null = null;\r\n    private mcp: McpClientService | null = null;\r\n\r\n    constructor(\r\n        private readonly _extensionUri: vscode.Uri,\r\n    ) {\r\n        this.config = new ConfigManager();\r\n        this.fsm = new AgentFSM();\r\n        this.session = new SessionManager();\r\n        // LLM Provider is initialized lazily based on user config\r\n\r\n        // Wire up the controller logic\r\n        this.messaging = new MessagingService(this.handleUserAction.bind(this));\r\n\r\n        // Listen for internal state changes\r\n        this.fsm.on('stateChanged', (state) => {\r\n            this.messaging.send({ type: 'STATE_CHANGED', newState: state });\r\n        });\r\n    }\r\n\r\n    public resolveWebviewView(\r\n        webviewView: vscode.WebviewView,\r\n        context: vscode.WebviewViewResolveContext,\r\n        _token: vscode.CancellationToken,\r\n    ) {\r\n        webviewView.webview.options = {\r\n            enableScripts: true,\r\n            localResourceRoots: [this._extensionUri]\r\n        };\r\n\r\n        webviewView.webview.html = this._getHtmlForWebview(webviewView.webview);\r\n        this.messaging.attachWebview(webviewView.webview);\r\n    }\r\n\r\n    private async handleUserAction(action: UserAction) {\r\n        console.log('[Controller] User Action:', action.type);\r\n\r\n        switch (action.type) {\r\n            case 'SUBMIT_PROMPT':\r\n                await this.handleSubmit(action.content);\r\n                break;\r\n            case 'STOP_GENERATION':\r\n                this.handleStop();\r\n                break;\r\n            case 'CLEAR_HISTORY':\r\n                this.session.startNewSession();\r\n                this.messaging.send({ type: 'REPLACE_TEXT', text: '' });\r\n                break;\r\n            case 'EDIT_MESSAGE':\r\n                await this.handleEditMessage(action.payload.id, action.payload.newContent);\r\n                break;\r\n        }\r\n    }\r\n\r\n    private async handleEditMessage(id: string, newContent: string) {\r\n        // 1. Abort current generation if active\r\n        if (this.fsm.getState() === 'WRITING' || this.fsm.getState() === 'THINKING') {\r\n            this.handleStop();\r\n        }\r\n\r\n        try {\r\n            // 2. Truncate and Update\r\n            this.session.truncateFrom(id);\r\n            this.session.updateMessageContent(id, newContent);\r\n\r\n            // 3. Notify Frontend of state change (truncated history)\r\n            // 3. Notify Frontend of state change (truncated history)\r\n            this.syncState();\r\n\r\n            // 4. Regenerate\r\n            await this.handleSubmit(newContent, { isRegeneration: true });\r\n\r\n        } catch (e: any) {\r\n            vscode.window.showErrorMessage(`Edit failed: ${e.message}`);\r\n        }\r\n    }\r\n\r\n    private async handleSubmit(content: string, options?: { isRegeneration: boolean }) {\r\n        if (this.fsm.getState() !== 'IDLE') return;\r\n\r\n        this.fsm.transition('THINKING');\r\n\r\n        // 1. Add User Message (if not regenerating)\r\n        if (!options?.isRegeneration) {\r\n            this.session.addMessage('user', content);\r\n        }\r\n\r\n        // 2. SYNC immediately so frontend gets the User Message ID\r\n        this.syncState();\r\n\r\n        const cfg = this.config.getConfig();\r\n        let fullResponse = ''; // Accumulator\r\n\r\n        try {\r\n            // Lazy initialization\r\n            this.llmProvider = LLMFactory.createProvider(cfg.model || 'qwen-max');\r\n            await this.llmProvider.initialize();\r\n\r\n            // Notify frontend to clear partial text if needed (for regeneration)\r\n            if (options?.isRegeneration) {\r\n                this.messaging.send({ type: 'REPLACE_TEXT', text: '' });\r\n                // We also need to ensure frontend state matches our truncated session BEFORE streaming\r\n                // The syncState() above handles that.\r\n            }\r\n\r\n            await this.llmProvider.streamChat(\r\n                {\r\n                    messages: this.session.getMessages().map(m => ({ role: m.role, content: m.content })),\r\n                    temperature: cfg.temperature\r\n                },\r\n                (chunk) => {\r\n                    if (this.fsm.getState() === 'IDLE') return; // Interrupted\r\n\r\n                    if (this.fsm.getState() === 'THINKING') {\r\n                        this.fsm.transition('WRITING');\r\n                    }\r\n                    fullResponse += chunk;\r\n                    this.messaging.send({ type: 'APPEND_TEXT', text: chunk });\r\n                }\r\n            );\r\n\r\n            // 3. Save Assistant Message and Sync\r\n            if (fullResponse && this.fsm.getState() !== 'IDLE') {\r\n                this.session.addMessage('assistant', fullResponse);\r\n                this.syncState();\r\n            }\r\n\r\n            this.fsm.transition('IDLE');\r\n            this.messaging.send({ type: 'DONE' });\r\n\r\n        } catch (e: any) {\r\n            this.fsm.transition('ERROR');\r\n            this.messaging.send({ type: 'ERROR', message: e.message || 'Unknown error' });\r\n            vscode.window.showErrorMessage(`LLM Error: ${e.message}`);\r\n        }\r\n    }\r\n\r\n    private syncState() {\r\n        this.messaging.send({\r\n            type: 'SYNC_MESSAGES',\r\n            messages: this.session.getMessages().map(m => ({\r\n                id: m.id,\r\n                role: m.role,\r\n                content: m.content\r\n            }))\r\n        });\r\n    }\r\n\r\n    private handleStop() {\r\n        // Logic to abort LLM request would go here (need to expose AbortController in LLMClient)\r\n        this.fsm.transition('IDLE');\r\n    }\r\n\r\n    private _getHtmlForWebview(webview: vscode.Webview) {\r\n        // Get the local path to main script run in the webview, then convert it to a uri we can use in the webview.\r\n        const stylesUri = webview.asWebviewUri(vscode.Uri.joinPath(this._extensionUri, \"webview-ui\", \"build\", \"assets\", \"index.css\"));\r\n        const scriptUri = webview.asWebviewUri(vscode.Uri.joinPath(this._extensionUri, \"webview-ui\", \"build\", \"assets\", \"index.js\"));\r\n\r\n        // Use a nonce to whitelist which scripts can be run\r\n        const nonce = getNonce();\r\n\r\n        return `<!DOCTYPE html>\r\n        <html lang=\"en\">\r\n        <head>\r\n            <meta charset=\"UTF-8\">\r\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n            <meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'none'; font-src ${webview.cspSource}; style-src ${webview.cspSource} 'unsafe-inline'; script-src 'nonce-${nonce}'; img-src ${webview.cspSource} data: https:;\">\r\n            <link rel=\"stylesheet\" type=\"text/css\" href=\"${stylesUri}\">\r\n            <title>NEXAIDE</title>\r\n        </head>\r\n        <body>\r\n            <div id=\"root\"></div>\r\n            <script nonce=\"${nonce}\" type=\"module\" src=\"${scriptUri}\"></script>\r\n        </body>\r\n        </html>`;\r\n    }\r\n}\r\n\r\nfunction getNonce() {\r\n    let text = \"\";\r\n    const possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\r\n    for (let i = 0; i < 32; i++) {\r\n        text += possible.charAt(Math.floor(Math.random() * possible.length));\r\n    }\r\n    return text;\r\n}\r\n","\r\nimport * as vscode from 'vscode';\r\nimport { ToWebviewMessage, UserAction } from '../api/types';\r\n\r\nexport class MessagingService {\r\n    private view: vscode.Webview | undefined;\r\n    private disposables: vscode.Disposable[] = [];\r\n\r\n    constructor(\r\n        private readonly onUserAction: (action: UserAction) => void\r\n    ) { }\r\n\r\n    public attachWebview(view: vscode.Webview) {\r\n        this.view = view;\r\n\r\n        view.onDidReceiveMessage(\r\n            (message: any) => {\r\n                // Runtime validation could happen here with Zod\r\n                this.onUserAction(message as UserAction);\r\n            },\r\n            null,\r\n            this.disposables\r\n        );\r\n    }\r\n\r\n    public send(message: ToWebviewMessage) {\r\n        if (this.view) {\r\n            this.view.postMessage(message);\r\n        } else {\r\n            console.warn('[Messaging] Webview not attached, dropping message:', message.type);\r\n        }\r\n    }\r\n\r\n    public dispose() {\r\n        this.disposables.forEach(d => d.dispose());\r\n        this.disposables = [];\r\n        this.view = undefined;\r\n    }\r\n}\r\n","\r\nimport { AgentState, AgentEvent, UserAction } from '../api/types';\r\nimport { EventEmitter } from 'events';\r\n\r\nexport class AgentFSM extends EventEmitter {\r\n    private currentState: AgentState = 'IDLE';\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    public getState(): AgentState {\r\n        return this.currentState;\r\n    }\r\n\r\n    public transition(newState: AgentState) {\r\n        // Simple validation logic (can be expanded with XState later)\r\n        if (this.currentState === newState) return;\r\n\r\n        console.log(`[FSM] State transition: ${this.currentState} -> ${newState}`);\r\n        this.currentState = newState;\r\n        this.emit('stateChanged', newState);\r\n    }\r\n\r\n    public handleAction(action: UserAction) {\r\n        switch (action.type) {\r\n            case 'SUBMIT_PROMPT':\r\n                if (this.currentState === 'IDLE' || this.currentState === 'ERROR') {\r\n                    this.transition('THINKING');\r\n                }\r\n                break;\r\n            case 'STOP_GENERATION':\r\n                if (this.currentState === 'THINKING' || this.currentState === 'WRITING') {\r\n                    this.transition('IDLE');\r\n                }\r\n                break;\r\n            case 'CLEAR_HISTORY':\r\n                this.transition('IDLE');\r\n                break;\r\n        }\r\n    }\r\n}\r\n","module.exports = require(\"events\");","\r\nimport * as vscode from 'vscode';\r\n\r\nexport interface AgentConfig {\r\n    apiUrl: string;\r\n    apiKey: string;\r\n    model: string;\r\n    temperature: number;\r\n    maxTokens: number;\r\n    agentMode: 'cli' | 'mcp';\r\n}\r\n\r\nexport class ConfigManager {\r\n    private static readonly SECTION = 'nexaide';\r\n\r\n    public getConfig(): AgentConfig {\r\n        const config = vscode.workspace.getConfiguration(ConfigManager.SECTION);\r\n\r\n        return {\r\n            apiUrl: config.get<string>('apiUrl') ?? 'https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions',\r\n            apiKey: config.get<string>('apiKey') ?? process.env.DASHSCOPE_API_KEY ?? '',\r\n            model: config.get<string>('model') ?? 'qwen-plus',\r\n            temperature: config.get<number>('temperature') ?? 0.7,\r\n            maxTokens: config.get<number>('maxTokens') ?? 2048,\r\n            agentMode: config.get<'cli' | 'mcp'>('agentMode') ?? 'mcp'\r\n        };\r\n    }\r\n\r\n    public async updateConfig(key: keyof AgentConfig, value: any) {\r\n        const config = vscode.workspace.getConfiguration(ConfigManager.SECTION);\r\n        await config.update(key, value, vscode.ConfigurationTarget.Global);\r\n    }\r\n}\r\n","\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\nexport interface ChatMessage {\r\n    id: string;\r\n    role: 'user' | 'assistant' | 'system';\r\n    content: string;\r\n    timestamp: number;\r\n}\r\n\r\nexport interface Session {\r\n    id: string;\r\n    messages: ChatMessage[];\r\n    createdAt: number;\r\n    updatedAt: number;\r\n}\r\n\r\nexport class SessionManager {\r\n    private currentSession: Session;\r\n    private history: Session[] = [];\r\n\r\n    constructor() {\r\n        this.currentSession = this.createNewSession();\r\n    }\r\n\r\n    private createNewSession(): Session {\r\n        const now = Date.now();\r\n        return {\r\n            id: uuidv4(),\r\n            messages: [],\r\n            createdAt: now,\r\n            updatedAt: now\r\n        };\r\n    }\r\n\r\n    public startNewSession() {\r\n        if (this.currentSession.messages.length > 0) {\r\n            this.history.push(this.currentSession);\r\n        }\r\n        this.currentSession = this.createNewSession();\r\n    }\r\n\r\n    public addMessage(role: 'user' | 'assistant' | 'system', content: string): ChatMessage {\r\n        const msg: ChatMessage = {\r\n            id: uuidv4(),\r\n            role,\r\n            content,\r\n            timestamp: Date.now()\r\n        };\r\n        this.currentSession.messages.push(msg);\r\n        this.currentSession.updatedAt = Date.now();\r\n        return msg;\r\n    }\r\n\r\n    public truncateFrom(messageId: string): void {\r\n        const index = this.currentSession.messages.findIndex(m => m.id === messageId);\r\n        if (index === -1) {\r\n            throw new Error(`Message with ID ${messageId} not found`);\r\n        }\r\n        // Keep messages up to and including the target message\r\n        this.currentSession.messages = this.currentSession.messages.slice(0, index + 1);\r\n        this.currentSession.updatedAt = Date.now();\r\n    }\r\n\r\n    public updateMessageContent(messageId: string, content: string): void {\r\n        const message = this.currentSession.messages.find(m => m.id === messageId);\r\n        if (!message) {\r\n            throw new Error(`Message with ID ${messageId} not found`);\r\n        }\r\n        message.content = content;\r\n        this.currentSession.updatedAt = Date.now();\r\n    }\r\n\r\n    public getMessages(): ChatMessage[] {\r\n        return this.currentSession.messages;\r\n    }\r\n\r\n    public getCurrentSessionId(): string {\r\n        return this.currentSession.id;\r\n    }\r\n\r\n    /**\r\n     * Prepare context for LLM (e.g. limit context window)\r\n     */\r\n    public getContextMetadata(): any {\r\n        return {\r\n            sessionId: this.currentSession.id,\r\n            turnCount: this.currentSession.messages.length / 2\r\n        };\r\n    }\r\n}\r\n","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;","import crypto from 'crypto';\nexport default {\n  randomUUID: crypto.randomUUID\n};","module.exports = require(\"crypto\");","import crypto from 'crypto';\nconst rnds8Pool = new Uint8Array(256); // # of random values to pre-allocate\n\nlet poolPtr = rnds8Pool.length;\nexport default function rng() {\n  if (poolPtr > rnds8Pool.length - 16) {\n    crypto.randomFillSync(rnds8Pool);\n    poolPtr = 0;\n  }\n\n  return rnds8Pool.slice(poolPtr, poolPtr += 16);\n}","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import { ILLMProvider } from './types';\r\nimport { QwenProvider } from './providers/qwen';\r\n\r\nexport class LLMFactory {\r\n    /**\r\n     * Create an LLM provider instance based on the model ID.\r\n     * @param modelId The model identifier (e.g. \"qwen-max\", \"gpt-4\")\r\n     */\r\n    static createProvider(modelId: string): ILLMProvider {\r\n        // Normalize model ID\r\n        const id = modelId.toLowerCase();\r\n\r\n        // Router logic\r\n        if (id.startsWith('qwen')) {\r\n            return new QwenProvider();\r\n        }\r\n\r\n        // Future extensions:\r\n        // if (id.startsWith('gpt')) return new OpenAIProvider();\r\n        // if (id.startsWith('claude')) return new AnthropicProvider();\r\n        // if (id.startsWith('gemini')) return new GeminiProvider();\r\n\r\n        // Default fallback (or throw error)\r\n        throw new Error(`Unsupported model: ${modelId}`);\r\n    }\r\n}\r\n","import { BaseProvider } from './base';\r\nimport { LLMRequest } from '../types';\r\n\r\nexport class QwenProvider extends BaseProvider {\r\n    readonly id = 'qwen-max'; // Default model\r\n    private apiKey: string = '';\r\n    private baseUrl: string = 'https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions';\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    async initialize(): Promise<void> {\r\n        this.apiKey = this.getApiKey('DASHSCOPE_API_KEY');\r\n    }\r\n\r\n    async chat(request: LLMRequest): Promise<string> {\r\n        const response = await this.makeRequest(request, false);\r\n        const data = await response.json() as any;\r\n        if (!response.ok) {\r\n            throw new Error(`Qwen API Error: ${data.error?.message || response.statusText}`);\r\n        }\r\n        return data.choices[0].message.content;\r\n    }\r\n\r\n    async streamChat(request: LLMRequest, onChunk: (chunk: string) => void): Promise<void> {\r\n        const response = await this.makeRequest(request, true);\r\n\r\n        if (!response.ok) {\r\n            const data = await response.json() as any;\r\n            throw new Error(`Qwen API Error: ${data.error?.message || response.statusText}`);\r\n        }\r\n\r\n        if (!response.body) {\r\n            throw new Error('Response body is null');\r\n        }\r\n\r\n        // Use standard Web Streams API (available in modern Node and VS Code)\r\n        const reader = response.body.getReader();\r\n        const decoder = new TextDecoder('utf-8');\r\n        let buffer = '';\r\n\r\n        try {\r\n            while (true) {\r\n                const { done, value } = await reader.read();\r\n                if (done) break;\r\n\r\n                const chunk = decoder.decode(value, { stream: true });\r\n                buffer += chunk;\r\n\r\n                const lines = buffer.split('\\n');\r\n                buffer = lines.pop() || ''; // Keep the last incomplete line\r\n\r\n                for (const line of lines) {\r\n                    const trimmed = line.trim();\r\n                    if (!trimmed || trimmed === 'data: [DONE]') continue;\r\n                    if (trimmed.startsWith('data: ')) {\r\n                        try {\r\n                            const data = JSON.parse(trimmed.slice(6)) as any;\r\n                            const content = data.choices[0]?.delta?.content;\r\n                            if (content) {\r\n                                onChunk(content);\r\n                            }\r\n                        } catch (e) {\r\n                            console.error('Failed to parse stream chunk:', e);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        } finally {\r\n            reader.releaseLock();\r\n        }\r\n    }\r\n\r\n    private async makeRequest(request: LLMRequest, stream: boolean): Promise<Response> {\r\n        if (!this.apiKey) {\r\n            await this.initialize();\r\n        }\r\n\r\n        const headers = {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': `Bearer ${this.apiKey}`\r\n        };\r\n\r\n        const body = {\r\n            model: this.id,\r\n            messages: request.messages,\r\n            stream: stream,\r\n            temperature: request.temperature ?? 0.7\r\n        };\r\n\r\n        return fetch(this.baseUrl, {\r\n            method: 'POST',\r\n            headers: headers,\r\n            body: JSON.stringify(body),\r\n            signal: request.abortSignal\r\n        });\r\n    }\r\n}\r\n","import { ILLMProvider, LLMRequest } from '../types';\r\n\r\nexport abstract class BaseProvider implements ILLMProvider {\r\n    abstract id: string;\r\n\r\n    constructor() { }\r\n\r\n    abstract initialize(): Promise<void>;\r\n\r\n    abstract streamChat(request: LLMRequest, onChunk: (chunk: string) => void): Promise<void>;\r\n\r\n    abstract chat(request: LLMRequest): Promise<string>;\r\n\r\n    protected getApiKey(envVarName: string): string {\r\n        // Priority: Process Env (for development/testing)\r\n        // In a real VS Code extension, this would also check vscode.workspace.getConfiguration()\r\n        const key = process.env[envVarName];\r\n        if (!key) {\r\n            throw new Error(`Missing environment variable: ${envVarName}`);\r\n        }\r\n        return key;\r\n    }\r\n}\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","\r\nimport * as vscode from 'vscode';\r\nimport { AIChatViewProvider } from './ui/ViewProvider';\r\n\r\nexport function activate(context: vscode.ExtensionContext) {\r\n    console.log('[NEXAIDE] Activating extension...');\r\n\r\n    const provider = new AIChatViewProvider(context.extensionUri);\r\n\r\n    context.subscriptions.push(\r\n        vscode.window.registerWebviewViewProvider(AIChatViewProvider.viewType, provider, {\r\n            webviewOptions: { retainContextWhenHidden: true }\r\n        })\r\n    );\r\n\r\n    context.subscriptions.push(\r\n        vscode.commands.registerCommand('nexaide.openChat', () => {\r\n            vscode.commands.executeCommand('workbench.view.extension.nexaide-sidebar');\r\n        })\r\n    );\r\n\r\n    console.log('[NEXAIDE] Activation complete.');\r\n}\r\n\r\nexport function deactivate() {\r\n    // Cleanup services if needed\r\n}\r\n"],"names":[],"ignoreList":[],"sourceRoot":""}